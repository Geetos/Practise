!function(t){var e={};function n(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._template=void 0;e._template={tableHeader:"<div class='myTable-header'><h3></h3><div class='panel-btn' id='panel'></div></div>",insertBtn:"<span id='add-item' class='btn btn-sm btn-success myTable-btn'><i class='fas fa-plus'></i>增加数据</span>",deleteBtn:"<span id='del-item' class='btn btn-sm btn-danger myTable-btn-cell myTable-btn-auto' style='color:white'><i class='fas fa-trash'></i></spam>",modifyBtn:"<span id='mod-item' class='btn btn-sm btn-info myTable-btn-cell myTable-btn-auto' style='color:white'><i class='fas fa-edit'></i></span>",createBtn:"<span id='cre-item' class='btn btn-sm btn-success myTable-btn-cell' style='color:white'><i class='fas fa-check'></i></span>",cancelBtn:"<span id='can-item' class='btn btn-sm btn-danger myTable-btn-cell' style='color:white'><i class='fas fa-times'></i></span>",commitBtn:"<span id='com-item' class='btn btn-sm btn-warning myTable-btn'><i class='fas fa-check'></i>提交更改</span>",searchText:"<div class='input-group'><div class='nput-group-prepend'><span class='input-group-text' id='basic-addon3'>搜索</span></div><input type='text' class='form-control' id='basic-url' aria-describedby='basic-addon3'></div>",newRowDot:"<div class='new-line-dot'></div>",modifyRowDot:"",deleteRowDot:"",searchTextField:null,table:"<div><table><thead><tr></tr></thead><tbody/></table><div>",textString:"<input>",textPercentage:"<input>%</input>",datetime:""}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._getDom=function(t){return t.startsWith("#")?$(t):$("#"+t)},e._getDomId=function(){for(var t="",e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];t=n[0].startsWith("#")?n[0]:"#"+n[0];for(var o=1;o<n.length;o++)t+=" "+n[o];return t},e._getDateTime=function(t){var e=new Date;e.setTime(t);var n=e.getFullYear(),a=e.getMonth()+1,o=e.getDate(),i=e.getHours(),r=e.getMinutes(),s=e.getSeconds();e.getMilliseconds();return n+"-"+a+"-"+o+" "+i+":"+r+":"+s},e._getConstType=function(t){switch(t){case"text":return DataUnit.STRING;case"percentage":return DataUnit.PERCENTAGE;case"number":return DataUnit.NUMBER;case"notnull":return DataUnit.NOTNULL;case"insert":return myAjax.INSERT;case"delete":return myAjax.DELETE;case"query":return myAjax.QUERY;case"modify":return myAjax.MODIFY}}},function(t,e,n){"use strict";var a=n(3);function o(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}new(function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dat=e,this.table=new a.tableClass(e),this.table.paint()}var e,n,i;return e=t,(n=[{key:"insert",value:function(t){var e=this;t.forEach(function(t){e.table.insert(t)})}},{key:"create",value:function(){this.table.create()}},{key:"modify",value:function(t,e){}},{key:"commitChange",value:function(){}},{key:"deleteRow",value:function(t){}},{key:"fetchData",value:function(){this.table.ajax(myAjax.QUERY)}}])&&o(e.prototype,n),i&&o(e,i),t}())({anchor:"table-test",fields:["合同金额","商品采购成本","转包实施成本","项目利润率","已回款金额","回款比例","项目合同回款要求"],keyname:["contractMoney","costMoney","subcontractingCost","profitMargin","paybackMoney","paybackRatio","reamek"],constraints:["notnull","notnull","notnull","notnull","notnull","notnull","notnull"],dataType:["number","number","number","percentage","number","number","string"],functions:{columnLine:!0,insert:!0,modify:!0,search:!0,delete:!0,commit:!0,refresh:!0,undoOperation:!0,autoReFresh:!1,refreshFrequency:1e3},style:{strip:!0,darkMode:!1,tableBorder:!0,headerPanel:!0,headerInfo:"资金明细表格"},ajax:[{action:"insert",type:"POST",url:"localhost/add",success:null,fail:null},{action:"modify",type:"POST",url:"localhost/modify",success:null,fail:null},{action:"query",type:"GET",url:"/moneyinfo/index/1",success:null,fail:null},{action:"delete",type:"POST",url:"localhost/delete",success:null,ail:null}]}).fetchData()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.tableClass=void 0;var a=n(1),o=n(4),i=n(5),r=n(0);function s(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dat=e,this.length=0,this.rowList=[],this.changeLog=[],this._ajax=new o.myAjax(this)}var e,n,l;return e=t,(n=[{key:"paint",value:function(){var t=this;0!=(0,a._getDom)(this.dat.anchor).length&&(this.dat.style.headerPanel&&($(r._template.tableHeader).appendTo((0,a._getDomId)(this.dat.anchor)),this.dat.style.hasOwnProperty("headerInfo")&&(0,a._getDom)((0,a._getDomId)(this.dat.anchor,"h3")).html(this.dat.style.headerInfo),this.dat.functions.search&&$(r._template.searchText).appendTo((0,a._getDomId)(this.dat.anchor,"#panel")),this.dat.functions.insert&&$(r._template.insertBtn).appendTo((0,a._getDomId)(this.dat.anchor,"#panel")),this.dat.functions.commit&&$(r._template.commitBtn).appendTo((0,a._getDomId)(this.dat.anchor,"#panel"))),$(r._template.table).appendTo((0,a._getDomId)(this.dat.anchor)),this.dat._table=(0,a._getDomId)(this.dat.anchor,"table"),this.dat.functions.columnLine&&$("<th>序号</th>").appendTo((0,a._getDomId)(this.dat._table,"thead","tr")),this.dat.fields.forEach(function(e){$("<th>"+e+"</th>").appendTo((0,a._getDomId)(t.dat._table,"thead","tr"))}),(0,a._getDom)((0,a._getDomId)(this.dat._table,"thead","tr","th:last")).addClass("lastSndCell"),$("<th class='lastCell'></th>").appendTo((0,a._getDomId)(this.dat._table,"thead","tr")),(0,a._getDom)(this.dat._table).addClass("myTable table table-sm "),this.dat.style.strip&&(0,a._getDom)(this.dat._table).addClass("table-striped"),this.dat.style.darkMode&&(0,a._getDom)(this.dat._table).addClass("table-dark"),this.dat.style.tableBorder&&(0,a._getDom)(this.dat._table).addClass("table-bordered"),this._addListener())}},{key:"_addListener",value:function(){var t=this;this.dat.functions.insert&&(0,a._getDom)((0,a._getDomId)(this.dat.anchor,"#add-item")).bind("click",function(){t.create()}),this.dat.functions.commit&&(0,a._getDom)((0,a._getDomId)(this.dat.anchor,"#com-item")).bind("click",function(){t.commitChange()})}},{key:"isEmpty",value:function(){return 0==(0,a._getDom)((0,a._getDomId)(this.dat._table,"tbody")).children().length}},{key:"insert",value:function(e){new i.rowClass(this.dat,this,t.INSERT).append(e)}},{key:"create",value:function(){new i.rowClass(this.dat,this,t.CREATE).create(1)}},{key:"searchTable",value:function(t){}},{key:"append",value:function(t,e){0==e||this.isEmpty()?t.appendTo((0,a._getDomId)(this.dat._table,"tbody")):(0,a._getDom)((0,a._getDomId)(this.dat._table,"tbody","tr:eq("+(e-1)+")")).before(t)}},{key:"commitChange",value:function(){var t=this,e={};this.changeLog.forEach(function(n){switch(n.type){case myTable.INSERT:e=function(e,n){for(var a={},o=0;o<n.length;o++)a[t.dat.keyname[o]]=n[o];return{type:e.type,url:e.url,dataType:"json",data:JSON.stringify(a)}}(t._getAjaxDat(myTable.INSERT),n.data)}}),console.log(e)}},{key:"clearTable",value:function(){(0,a._getDom)((0,a._getDomId)(this.dat._table,"tbody")).children().remove()}},{key:"undoOperation",value:function(){}},{key:"ajax",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this._ajax.execute(t,e)}}])&&s(e.prototype,n),l&&s(e,l),t}();e.tableClass=c,l(c,"INSERT",20),l(c,"CREATE",21),l(c,"COMMIT",22),l(c,"QUERY",23)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.myAjax=void 0;var a=n(1);function o(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e}var e,n,i;return e=t,(n=[{key:"execute",value:function(e,n){for(var o,i=0;i<this.table.dat.ajax.length;i++)(0,a._getConstType)(this.table.dat.ajax[i].action)==e&&(o=this.table.dat.ajax[i]);switch(e){case t.QUERY:var r=this._execu_ajax(o);if(null==r)alert("获取表信息出错，请检查配制信息是否正确");else for(var s=0;s<r.length;s++)this.table.insert(r[s])}}},{key:"_execu_ajax",value:function(t){return $.ajax({url:"/api/getWeather",data:{zipcode:97201},success:function(t){$("#weather-temp").html("<strong>"+t+"</strong> degrees")}}),null}}])&&o(e.prototype,n),i&&o(e,i),t}();e.myAjax=r,i(r,"INSERT",40),i(r,"QUERY",41),i(r,"MODIFY",42),i(r,"DELETE",43)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.rowClass=void 0;n(0);var a=n(6),o=n(7);function i(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var r=function(){function t(e,n,o){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n.rowList.push(this),this.dat=e,this.table=n,this.containerList=[],this.id,this.pos=0,this.originalData=[],this.currentData=[],this.rowDom=$("<tr/>"),e.functions.columnLine&&$("<th>"+(o==tableClass.INSERT?this.table.length+1:"#")+"</th>").appendTo(this.rowDom);for(var r=0;r<=e.fields.length;r++)$("<th "+(o==tableClass.INSERT?r<e.fields.length-1?"":r<e.fields.length?'class="lastSndCell"':'class="lastCell"':"")+"></th>").appendTo(this.rowDom);i=new a.myRowIncident(this),o==tableClass.INSERT?(this.dat.functions.delete&&i.hookUp(a.myRowIncident.DELETE),this.dat.functions.modify&&i.hookUp(a.myRowIncident.MODIFY)):o==tableClass.CREATE&&(this.rowDom.addClass("row-insert"),i.hookUp(a.myRowIncident.CANCLE),i.hookUp(a.myRowIncident.CREATE))}var e,n,r;return e=t,(n=[{key:"append",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.table.length+=1,this.originalData=t.concat(),this.currentData=t.concat(),this.pos=this.table.length;for(var n=0;n<t.length;n++)$(this.rowDom.children()[this.dat.functions.columnLine?n+1:n]).append(this._fillUnit(this.dat.dataType[n],this.dat.fields[n],this.dat.constraints[n],!1,t[n]));this.table.append(this.rowDom,e)}},{key:"create",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=0;n<this.dat.dataType.length;n++)$(this.rowDom.children()[this.dat.functions.columnLine?n+1:n]).append(this._fillUnit(this.dat.dataType[n],this.dat.fields[n],this.dat.constraints[n],!0,null==e?void 0:e[n]));this.table.append(this.rowDom,t)}},{key:"_fillUnit",value:function(t,e,n,a){var i,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;switch(t){case"string":i=new o.myText(o.myText.STRING,e,n);break;case"number":i=new o.myText(o.myText.NUMBER,e,n);break;case"percentage":i=new o.myText(o.myText.PERCENTAGE,e,n)}return null!=r&&i.set(r),i.editable(a),this.containerList.push(i),i.createDOM()}},{key:"remove",value:function(){this.table.rowList.pop(this.table.rowList.indexOf(this)),this.rowDom.remove()}},{key:"modify",value:function(t){var e={};for(var n in t){var o=this.dat.keyname.indexOf(n);this.currentData[o]=t[n],this.containerList[o].set(t[n]),e[n]=t[n]}this.table.changeLog.push({type:a.myRowIncident.MODIFY,data:e})}}])&&i(e.prototype,n),r&&i(e,r),t}();e.rowClass=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.myRowIncident=void 0;var a=n(0);function o(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.panel=$("<span/>"),this.row=e,this.panel.appendTo(e.rowDom.children("th:last"))}var e,n,i;return e=t,(n=[{key:"hookUp",value:function(e){var n,o=this;switch(e){case t.DELETE:(n=$(a._template.deleteBtn).clone()).bind("click",function(){o.row.remove(),o.row.table.changeLog.push({type:t.DELETE})});break;case t.MODIFY:(n=$(a._template.modifyBtn).clone()).bind("click",function(){o._flush(),o.hookUp(t.UNDO_MODIFY),o.hookUp(t.COMMIT_MODIFY),o.row.rowDom.addClass("row-modify"),o.row.containerList.forEach(function(t){t.editable(!0)})});break;case t.CANCLE:(n=$(a._template.cancelBtn).clone()).bind("click",function(){o.row.remove()});break;case t.CREATE:(n=$(a._template.createBtn).clone()).bind("click",function(){var t=[],e=!0;o.row.containerList.forEach(function(n){n.check(!0)?t.push(n.get()):e=!1}),e&&(o.row.table.insert(t),o.row.remove(),o.row.table.changeLog.push({type:tableClass.INSERT,data:t}))});break;case t.UNDO_MODIFY:(n=$(a._template.cancelBtn).clone()).bind("click",function(){o._flush(),o.hookUp(t.DELETE),o.hookUp(t.MODIFY);for(var e=0;e<o.row.containerList.length;e++)o.row.containerList[e].set(o.row.currentData[e]),o.row.containerList[e].editable(!1);o.row.rowDom.removeClass("row-modify")});break;case t.COMMIT_MODIFY:(n=$(a._template.createBtn).clone()).bind("click",function(){for(var e={},n=!0,a=0;a<o.row.containerList.length;a++){var i=o.row.containerList[a];if(!i.check(!0)){n=!1;break}i.get()!=o.row.currentData[a]&&(e[o.row.dat.keyname[a]]=i.get())}n&&(o.row.modify(e),o._flush(),o.hookUp(t.DELETE),o.hookUp(t.MODIFY),o.row.containerList.forEach(function(t){t.editable(!1)}),o.row.rowDom.removeClass("row-modify"))})}n.appendTo(this.panel)}},{key:"_flush",value:function(){this.panel.children().remove()}}])&&o(e.prototype,n),i&&o(e,i),t}();e.myRowIncident=r,i(r,"DELETE",30),i(r,"MODIFY",31),i(r,"CANCLE",32),i(r,"CREATE",33),i(r,"UNDO_MODIFY",34),i(r,"COMMIT_MODIFY",35)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.myText=void 0;var a=n(0);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function r(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u=function(t){function e(t,n,o){var i;switch(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=r(this,s(e).call(this))).type=t,i.fieldName=n,i.dom=null,i.constraint=o,t){case e.STRING:i.dom=$(a._template.textString).addClass("myText-string");break;case e.PERCENTAGE:i.dom=$(a._template.textPercentage).addClass("myText-number");break;case e.NUMBER:i.dom=$(a._template.textString).addClass("myText-number")}return i}var n,o,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,myUnitBase),n=e,(o=[{key:"set",value:function(t){this.dom.val(t)}},{key:"get",value:function(){return this.dom.val()}},{key:"clear",value:function(){this.dom.val("")}},{key:"check",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!0,a="";if("notnull"==this.constraint&&0==this.get().length)n=!1,a="不能为空！";else if(this.type==e.NUMBER||this.type==e.PERCENTAGE){/^(-?\d+)(\.\d+)?$/.test(this.get())||(n=!1,a="不是合法数字!")}return!!n||(t&&alert("'"+this.fieldName+"'项 "+a),!1)}},{key:"createDOM",value:function(){return this.dom}},{key:"editable",value:function(t){this.dom[0].disabled=!t}}])&&i(n.prototype,o),c&&i(n,c),e}();e.myText=u,c(u,"STRING",0),c(u,"PERCENTAGE",1),c(u,"NUMBER",2)}]);