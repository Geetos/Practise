package com.jxtele.projectmanage.controller;

import com.jxtele.projectmanage.annotation.Permission;
import com.jxtele.projectmanage.controller.base.BaseController;
import com.jxtele.projectmanage.entity.PermissionType;
import com.jxtele.projectmanage.entity.XmpercentageItem;
import com.jxtele.projectmanage.service.IUserService;
import com.jxtele.projectmanage.service.XmpercentageItemService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.thymeleaf.util.StringUtils;

import java.util.List;

@Controller
@RequestMapping("/xmpercentageItem")
public class XmpercentageItemController extends BaseController {
    @Autowired
    private XmpercentageItemService xmpercentageItemService;
    @Autowired
    private IUserService userService;
    private static final String qxurl = "xmpercentageItem/list";

    /**
     *增加项目提的分配数据（人员，分配金额，参与项目时间...）
     * @param recode
     * @return
     */
    @RequestMapping(value="/list",method= RequestMethod.GET)
    @Permission(url = qxurl,type = PermissionType.ADD)
    public Integer AddXMpercentageItem(@ModelAttribute XmpercentageItem recode){
        if(StringUtils.isEmpty(String.valueOf(recode.getId()))){
            return 0;
        }
        return xmpercentageItemService.insert(recode);
    }
    /**
     * 查询提成详细数据列表
     */
    @RequestMapping(value="/itemlist",method=RequestMethod.GET)
    @Permission(url = qxurl,type = PermissionType.QUERY)
    public Object rcentageItemManageInfo(@PathVariable Integer percentageId, Model model){
        List<XmpercentageItem> xmlist = xmpercentageItemService.selectByPercentId(percentageId);
        model.addAttribute("xmlist", xmlist);
        return "page/xmpercentageItem/list";
    }

    /**
     * 删除某提成项目的分配某条详细数据
     * @param id
     * @return
     */
    @RequestMapping(value="/delitem",method=RequestMethod.GET)
    @Permission(url = qxurl,type = PermissionType.DEL)
    public Object delRcentageItemInfo(@PathVariable Integer id){
        return xmpercentageItemService.deleteByPrimaryKey(id);
    }

    /**
     * 修改
     * @param record
     * @return
     */
    @RequestMapping(value="/updateitem",method=RequestMethod.POST)
    @Permission(url = qxurl,type = PermissionType.EDIT)
    public Object editRcentage(@ModelAttribute XmpercentageItem record){
        return xmpercentageItemService.updateByPrimaryKey(record);
    }
}
